<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inteli.gente - Londrina</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: #f5f7fa;
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }
        
        .header {
            display: flex;
            align-items: center;
            padding: 20px 40px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid #eee;
            position: relative;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .back-button {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #513C9A;
            font-size: 16px;
            font-weight: 500;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s ease;
            position: absolute;
            left: 40px;
        }

        .back-button:hover {
            color: #6B4FB5;
        }

        .logo-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            width: 45px;
            height: 45px;
            background: linear-gradient(45deg, #513C9A, #6B4FB5);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            color: white;
        }
        
        .logo-text {
            font-size: 24px;
            font-weight: bold;
            color: #513C9A;
        }

        .main-content {
            padding: 40px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .page-title {
            text-align: center;
            margin-bottom: 40px;
        }

        .page-title h1 {
            color: #513C9A;
            font-size: 42px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .page-title p {
            color: #666;
            font-size: 18px;
        }

        .purple-section {
            background: linear-gradient(135deg, #513C9A 0%, #6B4FB5 100%);
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
            color: white;
            box-shadow: 0 10px 30px rgba(81, 60, 154, 0.2);
        }

        .section-title {
            color: white;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 16px;
            text-align: center;
        }

        .section-subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-size: 16px;
            margin-bottom: 32px;
            text-align: center;
        }

        .municipality-dropdowns {
            display: flex;
            gap: 24px;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 20px;
        }

        .municipality-select-container {
            position: relative;
            min-width: 250px;
        }

        .municipality-select {
            background: white;
            color: #333;
            border: 2px solid #ddd;
            padding: 12px 16px;
            border-radius: 12px;
            font-size: 16px;
            font-family: 'Poppins', sans-serif;
            cursor: pointer;
            min-width: 200px;
            transition: all 0.3s;
            width: 100%;
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 12px center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: 40px;
        }

        .municipality-select:focus {
            outline: none;
            border-color: #513C9A;
            box-shadow: 0 0 0 3px rgba(81, 60, 154, 0.1);
        }

        .municipality-select:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .action-button {
            background: linear-gradient(45deg, #513C9A, #6B4FB5);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(81, 60, 154, 0.3);
            font-family: 'Poppins', sans-serif;
            font-size: 16px;
            min-width: 200px;
        }

        .action-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(81, 60, 154, 0.4);
        }

        .action-button.danger {
            background: #dc3545;
            color: white;
            border: 2px solid #dc3545;
        }

        .action-button.danger:hover {
            background: #c82333;
            border-color: #c82333;
        }

        .selection-display {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-top: 24px;
            text-align: center;
            color: white;
            display: none;
        }

        .selection-display.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .white-section {
            background: white;
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .white-section-title {
            color: #513C9A;
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .white-section-text {
            color: #666;
            font-size: 18px;
            line-height: 1.8;
        }

        .hidden {
            display: none;
        }

        .city-header {
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(90deg, #513C9A, #6B4FB5);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(81, 60, 154, 0.3);
        }

        .city-name {
            font-size: 2.5rem;
            font-weight: bold;
            text-align: center;
        }

        .characterization-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .char-title {
            color: #513C9A;
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #513C9A;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .char-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .char-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #513C9A;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .char-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(81, 60, 154, 0.15);
        }

        .char-label {
            font-size: 13px;
            color: #666;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .char-value {
            font-size: 24px;
            font-weight: 700;
            color: #513C9A;
        }

        .indicators-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .indicator-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border-left: 5px solid #513C9A;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .indicator-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(81, 60, 154, 0.2);
        }

        .indicator-name {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .indicator-value {
            font-size: 28px;
            font-weight: 700;
            color: #513C9A;
            margin-bottom: 8px;
        }

        .indicator-level {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            background: linear-gradient(45deg, #513C9A, #6B4FB5);
            color: white;
        }

        .category-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .category-title {
            color: #513C9A;
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #513C9A;
        }

        .nivel-badge {
            display: inline-block;
            width: 30px;
            height: 30px;
            line-height: 30px;
            border-radius: 50%;
            font-weight: 700;
            font-size: 14px;
            text-align: center;
            margin-left: 8px;
        }

        .nivel-1 { background: #dc3545; color: white; }
        .nivel-2 { background: #fd7e14; color: white; }
        .nivel-3 { background: #ffc107; color: #333; }
        .nivel-4 { background: #20c997; color: white; }
        .nivel-5 { background: #17a2b8; color: white; }
        .nivel-6 { background: #007bff; color: white; }
        .nivel-7 { background: #28a745; color: white; }

        .future-message {
            background: white;
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .future-message h2 {
            color: #513C9A;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 20px;
            text-align: center;
        }

        .future-message p {
            text-align: center;
            font-size: 16px;
            color: #666;
            line-height: 1.8;
        }

        @media (max-width: 992px) {
            .main-content {
                padding: 20px;
            }
            
            .page-title h1 {
                font-size: 36px;
            }
            
            .indicators-grid,
            .char-grid {
                grid-template-columns: 1fr;
            }

            .municipality-dropdowns {
                flex-direction: column;
                align-items: center;
            }

            .municipality-select-container {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <a href="#" class="back-button" onclick="history.back(); return false;">
            ‚Üê Voltar para Plataformas
        </a>
        <div class="logo-header">
            <div class="logo">
                <div class="logo-icon">IG</div>
                <span class="logo-text">Inteli.gente</span>
            </div>
        </div>
    </div>

    <div class="main-content">
        <div class="page-title">
            <h1>Inteli.gente</h1>
            <p>Indicadores de Cidades Inteligentes</p>
        </div>

        <div class="purple-section">
            <h2 class="section-title">Selecione um munic√≠pio</h2>
            <p class="section-subtitle">Escolha o munic√≠pio para visualizar os indicadores Inteli.gente</p>
            
            <div class="municipality-dropdowns">
                <div class="municipality-select-container">
                    <select id="uf-select" class="municipality-select" onchange="selectUF()">
                        <option value="">Carregando estados...</option>
                    </select>
                </div>
                <div class="municipality-select-container">
                    <select id="municipality-select" class="municipality-select" onchange="selectMunicipality()" disabled>
                        <option value="">Primeiro selecione o estado</option>
                    </select>
                </div>
            </div>

            <div class="selection-display" id="selection-display">
                <h3>Munic√≠pio Selecionado:</h3>
                <p id="selection-text"></p>
            </div>
            
            <div class="action-buttons">
                <button class="action-button danger" onclick="clearSelection()">üóëÔ∏è Limpar Sele√ß√£o</button>
            </div>
        </div>

        <div id="summary-section" class="white-section">
            <h2 class="white-section-title">Resumo Inteli.gente</h2>
            <p class="white-section-text">
                Selecione um munic√≠pio para visualizar os indicadores de Cidades Inteligentes.<br>
                Os dados est√£o organizados em: Caracteriza√ß√µes, Economia, Meio Ambiente, Sociocultural e Capacidades Institucionais.
            </p>
        </div>

        <div id="future-implementation" class="future-message hidden">
            <h2>Implementa√ß√£o Futura</h2>
            <p>
                No momento, apenas a cidade de Londrina-PR possui dados dispon√≠veis.<br>
                Estamos trabalhando para incluir mais munic√≠pios em breve.
            </p>
        </div>

        <div id="municipality-dashboard" class="hidden">
            <div class="city-header">
                <div class="city-name" id="selected-municipality">Londrina - PR</div>
            </div>

            <!-- Caracteriza√ß√µes -->
            <div id="characterizations-section">
                <div class="characterization-section">
                    <h3 class="char-title">üìä Caracteriza√ß√£o Sociodemogr√°fica</h3>
                    <div class="char-grid" id="socio-grid"></div>
                </div>

                <div class="characterization-section">
                    <h3 class="char-title">üíª Caracteriza√ß√£o da Transforma√ß√£o Digital</h3>
                    <div class="char-grid" id="digital-grid"></div>
                </div>

                <div class="characterization-section">
                    <h3 class="char-title">üèõÔ∏è Caracteriza√ß√£o Institucional</h3>
                    <div class="char-grid" id="institutional-grid"></div>
                </div>
            </div>

            <!-- Seletor de Dimens√£o -->
            <div class="purple-section" style="margin-top: 30px;">
                <div class="municipality-dropdowns">
                    <div class="municipality-select-container">
                        <select id="dimension-selector" class="municipality-select" onchange="changeDimension()">
                            <option value="">Selecione uma dimens√£o para ver indicadores</option>
                            <option value="economia">Economia</option>
                            <option value="meio_ambiente">Meio Ambiente</option>
                            <option value="sociocultural">Sociocultural</option>
                            <option value="capacidades">Capacidades Institucionais</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Conte√∫dos das Dimens√µes -->
            <div id="economia-content" class="dimension-content hidden"></div>
            <div id="meio_ambiente-content" class="dimension-content hidden"></div>
            <div id="sociocultural-content" class="dimension-content hidden"></div>
            <div id="capacidades-content" class="dimension-content hidden"></div>
        </div>
    </div>

    <script>
        const caracterizacoesData = {"municipio":{"caracterizacao_sociodemografica":{"populacao_total_estimada":555965,"rede_influencia_cidade":"Capital Regional B","pib_per_capita":40636.89,"pib":{"agropecuaria":529678,"industria":4346594,"servicos":12880971,"administracao_publica":2808055},"populacao_ocupada_vinculo_formal":null,"indice_gini_renda_domiciliar":0.523,"idh_municipal":0.778,"capacidade_pagamento_capag":"C"},"caracterizacao_transformacao_digital":{"empregos_tic":11671,"empresas_tic":1332,"campus_institutos_universidades_federais":2,"empresas_parques_tecnologicos":8,"incubadoras_credenciadas_lei_tic":null,"instituicoes_ensino_pesquisa_pdi_lei_tic":2,"centros_institutos_pdi_lei_tic":null,"empresas_habilitadas_lei_tic":3,"empresas_lei_bem_pdi":13},"caracterizacao_institucional":{"equipe_ti_tamanho":null,"estrutura_organizacional_tic":"Funcion√°rios efetivos","incorporacao_tics_areas_prioritarias":null,"governanca_tecnologica_responsaveis":null,"governanca_ti_responsavel":null}}};

        const economiaData = {"municipio":{"indicadores":{"agua_esgoto":{"indice_populacao_total_atendimento_agua":{"valor":99.99,"unidade":"%","nivel":7},"indice_populacao_total_atendimento_esgoto":{"valor":99.99,"unidade":"%","nivel":7},"indice_populacao_urbana_atendimento_esgoto":{"valor":99.99,"unidade":"%","nivel":7}},"residuos_solidos":{"taxa_populacao_coberta_coleta_residuos":{"valor":98.99,"unidade":"%","nivel":6},"coleta_seletiva_residuos":{"valor":true,"nivel":7}},"habitacao":{"percentual_domicilios_aglomerados_subnormais":{"valor":1.67,"unidade":"%","nivel":5},"assentamentos_urbanos_precarios":{"valor":4,"nivel":1},"programas_acoes_habitacionais":{"valor":6,"nivel":4}},"transporte":{"servicos_regulares_transporte_passageiros":{"valor":9,"nivel":3},"servicos_compartilhamento_viagens":{"valor":null,"nivel":2},"servico_informacoes_transporte_publico_tempo_real":{"valor":null,"nivel":2},"servicos_solucoes_inteligentes_mobilidade":{"valor":1,"nivel":4},"acessibilidade_transporte_publico":{"valor":3,"nivel":4},"ciclomobilidade":{"valor":3,"nivel":3}},"urbanizacao_vias_publicas":{"indice_pavimentacao_vias":{"valor":98.36,"unidade":"%","nivel":6}},"infraestrutura_conectividade":{"escala_acesso_banda_larga_fixa":{"valor":39.87,"unidade":"%","nivel":6},"escala_acesso_banda_larga_movel":{"valor":125.17,"unidade":"%","nivel":7},"cobertura_banda_larga_movel_3g_4g":{"valor":3,"nivel":6},"cobertura_fibra_otica":{"valor":true,"nivel":5},"rede_tecnologia_equipamentos_edificios_publicos":{"valor":3,"nivel":5},"escala_acesso_banda_larga_fixa_alta_velocidade":{"valor":32.68,"unidade":"%","nivel":6},"numero_estacoes_radio_base":{"valor":53,"nivel":3}},"inovacao":{"qualificacao_profissional_intermediacao_mao_obra":{"valor":6,"nivel":6},"inclusao_produtiva_urbana":{"valor":4,"nivel":3},"acesso_credito_microcredito_seguro":{"valor":4,"nivel":3},"geracao_trabalho_renda":{"valor":5,"nivel":6}},"sistemas_tecnologia_gestao_urbana":{"sistema_informacao_geografica":{"valor":8,"nivel":7},"centros_comando_controle":{"valor":1,"nivel":3},"plataforma_integrada_cidade_inteligente":{"valor":null,"nivel":1}},"servicos_online_prefeitura":{"servicos_website_prefeitura":{"valor":15,"nivel":6}},"dados_abertos":{"dados_abertos_gestao_municipal":{"valor":9,"nivel":6}}}}};

        const meioAmbienteData = {"municipio":{"indicadores":{"agua_esgoto":{"indice_volume_esgoto_coletado":{"valor":89.06,"unidade":"%","nivel":6},"consumo_medio_per_capita_agua":{"valor":178.10,"unidade":"litros/hab","nivel":2},"solucoes_inteligentes_gestao_distribuicao_consumo_agua":{"valor":null,"nivel":1},"indice_perdas_distribuicao_agua":{"valor":33.72,"unidade":"%","nivel":4},"indice_volume_esgoto_tratado":{"valor":100.00,"unidade":"%","nivel":7}},"residuos_solidos":{"percentual_material_recolhido_coleta_seletiva":{"valor":null,"nivel":1},"solucoes_inteligentes_otimizacao_coleta_residuos":{"valor":null,"nivel":1}},"areas_verdes":{"protecao_gestao_meio_ambiente_areas_verdes_municipio":{"valor":7,"nivel":6}},"qualidade_ar":{"solucoes_monitoramento_gases_efeito_estufa_qualidade_ar":{"valor":null,"nivel":1},"monitoramento_qualidade_ar":{"valor":null,"nivel":1}},"energia":{"solucoes_inteligentes_gestao_consumo_energia_eletrica":{"valor":null,"nivel":1},"solucoes_telegestao_iluminacao_publica":{"valor":null,"nivel":1}}}}};

        const socioculturalData = {"municipio":{"indicadores":{"educacao":{"indice_equipamentos_tecnologia_escolas_publicas":{"valor":56.31,"unidade":"%","nivel":6},"taxa_analfabetismo":{"valor":4.2,"unidade":"%","nivel":5},"ideb_anos_finais":{"valor":null,"nivel":1},"vagas_ensino_superior":{"valor":3084,"nivel":4},"centros_educacao_tecnologica":{"valor":null,"nivel":1},"acoes_educacao_comunidades_especificas":{"valor":1,"nivel":2},"taxas_distorcao_idade_serie":{"valor":5.3,"unidade":"%","nivel":7},"percentual_escolas_municipais_acesso_internet":{"valor":99.17,"unidade":"%","nivel":7},"computadores_uso_alunos":{"valor":2942,"nivel":5}},"cultura":{"estrutura_equipamentos_culturais_esportivos":{"valor":24,"nivel":7},"protecao_patrimonio_cultural":{"valor":7,"nivel":6},"servicos_online_promocao_cultura":{"valor":null,"nivel":2},"servicos_culturais_online_populacao":{"valor":null,"nivel":2}},"saude":{"servicos_telemedicina_telessaude":{"valor":null,"nivel":2},"leitos_hospitalares_rede_publica":{"valor":218,"nivel":3},"medicos_disponiveis_rede_publica":{"valor":504,"nivel":7},"prontuario_eletronico":{"valor":null,"nivel":1},"servicos_online_saude_pacientes":{"valor":null,"nivel":2},"indice_risco_protecao_saude_nascidos_vivos":{"valor":0.122,"nivel":4},"mortalidade_materna":{"valor":32.70,"unidade":"%","nivel":3}},"seguranca_publica":{"solucoes_monitoramento_seguranca":{"valor":null,"nivel":2},"taxa_homicidios":{"valor":16.18,"unidade":"%","nivel":4},"politicas_publicas_acoes_seguranca":{"valor":3,"nivel":3}},"gestao_desastres":{"solucoes_tecnologia_monitoramento_desastres":{"valor":3,"nivel":5},"vulnerabilidade_riscos_desastres_naturais":{"valor":5,"nivel":1}},"inclusao_digital":{"promocao_inclusao_digital":{"valor":3,"nivel":5},"cursos_capacitacao_tecnologica":{"valor":3,"nivel":6}},"inclusao_social":{"politicas_publicas_mulheres":{"valor":9,"nivel":6},"inclusao_social_grupos_especificos":{"valor":2,"nivel":2}},"participacao_publica":{"formas_presenciais_participacao":{"valor":4,"nivel":4},"formas_online_participacao":{"valor":0,"nivel":1}}}}};

        const capacidadesData = {"municipio":{"indicadores":{"estrategia":{"governanca_colaborativa_responsaveis":{"valor":null,"nivel":1},"incorporacao_tics_planejamento":{"valor":null,"nivel":1},"planejamento_estrategico_transformacao_digital":{"valor":null,"nivel":1}},"infraestrutura_hw_sw":{"governanca_ti_praticas":{"valor":null,"nivel":1},"infraestrutura_hw_sw_armazenamento":{"valor":null,"nivel":1}},"servicos_aplicacoes":{"gestao_integrada_dados":{"valor":null,"nivel":2},"servicos_publicos_online":{"valor":15,"nivel":6},"solicitacao_servicos_publicos":{"valor":7,"nivel":5}},"monitoramento":{"seguranca_politicas_publicas_monitoramento":{"valor":null,"nivel":1},"percepcao_servicos_publicos":{"valor":0,"nivel":1},"transparencia_monitoramento":{"valor":null,"nivel":1}},"dados_abertos":{"transparencia_execucao_orcamentaria_financeira":{"valor":5,"nivel":5},"transparencia_dados_disponibilizacao":{"valor":9,"nivel":6},"seguranca_dados_praticas":{"valor":null,"nivel":1}}}}};

        let allStates = [];
        let selectedState = null;
        let selectedMunicipalityData = null;

        async function loadStates() {
            try {
                const response = await fetch('https://servicodados.ibge.gov.br/api/v1/localidades/estados?orderBy=nome');
                const states = await response.json();
                
                allStates = states;
                populateStatesDropdown(states);
            } catch (error) {
                console.error('Erro ao carregar estados:', error);
                document.getElementById('uf-select').innerHTML = '<option value="">Erro ao carregar estados</option>';
            }
        }

        function populateStatesDropdown(states) {
            const ufSelect = document.getElementById('uf-select');
            ufSelect.innerHTML = '<option value="">Selecione o Estado</option>';
            
            states.forEach(state => {
                const option = document.createElement('option');
                option.value = state.id;
                option.textContent = `${state.nome} (${state.sigla})`;
                ufSelect.appendChild(option);
            });
        }

        async function selectUF() {
            const ufSelect = document.getElementById('uf-select');
            const municipalitySelect = document.getElementById('municipality-select');
            const selectedStateId = ufSelect.value;

            if (!selectedStateId) {
                municipalitySelect.innerHTML = '<option value="">Primeiro selecione o estado</option>';
                municipalitySelect.disabled = true;
                selectedState = null;
                hideSelection();
                return;
            }

            selectedState = allStates.find(state => state.id == selectedStateId);
            
            municipalitySelect.innerHTML = '<option value="">Carregando munic√≠pios...</option>';
            municipalitySelect.disabled = true;

            try {
                const response = await fetch(`https://servicodados.ibge.gov.br/api/v1/localidades/estados/${selectedStateId}/municipios?orderBy=nome`);
                const municipalities = await response.json();
                
                municipalitySelect.innerHTML = '<option value="">Selecione o Munic√≠pio</option>';
                municipalities.forEach(municipality => {
                    const option = document.createElement('option');
                    option.value = municipality.id;
                    option.textContent = municipality.nome;
                    option.dataset.municipalityData = JSON.stringify(municipality);
                    municipalitySelect.appendChild(option);
                });
                
                municipalitySelect.disabled = false;
                
            } catch (error) {
                console.error('Erro ao carregar munic√≠pios:', error);
                municipalitySelect.innerHTML = '<option value="">Erro ao carregar munic√≠pios</option>';
            }
        }

        function selectMunicipality() {
            const municipalitySelect = document.getElementById('municipality-select');
            const selectedOption = municipalitySelect.options[municipalitySelect.selectedIndex];
            
            if (!selectedOption.value) {
                hideSelection();
                return;
            }

            selectedMunicipalityData = JSON.parse(selectedOption.dataset.municipalityData);
            showSelection();
            
            if (selectedMunicipalityData.nome.toLowerCase() === 'londrina' && 
                selectedMunicipalityData.microrregiao.mesorregiao.UF.sigla.toUpperCase() === 'PR') {
                showDashboard();
            } else {
                showFutureImplementation();
            }
        }

        function showSelection() {
            if (!selectedMunicipalityData) return;

            const display = document.getElementById('selection-display');
            const text = document.getElementById('selection-text');
            const state = selectedMunicipalityData.microrregiao.mesorregiao.UF;
            
            text.innerHTML = `<strong>${selectedMunicipalityData.nome}</strong> - ${state.nome} (${state.sigla})`;
            display.classList.add('show');
            
            document.getElementById('summary-section').classList.add('hidden');
        }

        function hideSelection() {
            document.getElementById('selection-display').classList.remove('show');
            selectedMunicipalityData = null;
            document.getElementById('summary-section').classList.remove('hidden');
            document.getElementById('municipality-dashboard').classList.add('hidden');
            document.getElementById('future-implementation').classList.add('hidden');
        }

        function showDashboard() {
            document.getElementById('municipality-dashboard').classList.remove('hidden');
            document.getElementById('future-implementation').classList.add('hidden');
            document.getElementById('selected-municipality').textContent = 'Londrina - PR';
            
            renderCharacterizations();
            
            document.getElementById('dimension-selector').value = '';
            document.querySelectorAll('.dimension-content').forEach(el => el.classList.add('hidden'));
        }

        function showFutureImplementation() {
            document.getElementById('municipality-dashboard').classList.add('hidden');
            document.getElementById('future-implementation').classList.remove('hidden');
        }

        function clearSelection() {
            selectedMunicipalityData = null;
            selectedState = null;
            
            document.getElementById('uf-select').value = '';
            document.getElementById('municipality-select').value = '';
            document.getElementById('municipality-select').innerHTML = '<option value="">Primeiro selecione o estado</option>';
            document.getElementById('municipality-select').disabled = true;
            
            hideSelection();
        }

        function renderCharacterizations() {
            const socio = caracterizacoesData.municipio.caracterizacao_sociodemografica;
            const digital = caracterizacoesData.municipio.caracterizacao_transformacao_digital;
            const institutional = caracterizacoesData.municipio.caracterizacao_institucional;

            const socioGrid = document.getElementById('socio-grid');
            socioGrid.innerHTML = '';
            
            addCharCard(socioGrid, 'Popula√ß√£o Total Estimada', socio.populacao_total_estimada?.toLocaleString('pt-BR') || 'N/D');
            addCharCard(socioGrid, 'Rede de Influ√™ncia da Cidade', socio.rede_influencia_cidade || 'N/D');
            addCharCard(socioGrid, 'PIB per Capita', socio.pib_per_capita ? `R$ ${socio.pib_per_capita.toLocaleString('pt-BR', {minimumFractionDigits: 2})}` : 'N/D');
            addCharCard(socioGrid, 'IDH Municipal', socio.idh_municipal || 'N/D');
            addCharCard(socioGrid, '√çndice Gini', socio.indice_gini_renda_domiciliar || 'N/D');
            addCharCard(socioGrid, 'Capacidade de Pagamento (CAPAG)', socio.capacidade_pagamento_capag || 'N/D');
            
            if (socio.pib) {
                addCharCard(socioGrid, 'PIB Agropecu√°ria', `R$ ${(socio.pib.agropecuaria / 1000).toLocaleString('pt-BR', {minimumFractionDigits: 0})} mil`);
                addCharCard(socioGrid, 'PIB Ind√∫stria', `R$ ${(socio.pib.industria / 1000).toLocaleString('pt-BR', {minimumFractionDigits: 0})} mil`);
                addCharCard(socioGrid, 'PIB Servi√ßos', `R$ ${(socio.pib.servicos / 1000).toLocaleString('pt-BR', {minimumFractionDigits: 0})} mil`);
                addCharCard(socioGrid, 'PIB Adm. P√∫blica', `R$ ${(socio.pib.administracao_publica / 1000).toLocaleString('pt-BR', {minimumFractionDigits: 0})} mil`);
            }

            const digitalGrid = document.getElementById('digital-grid');
            digitalGrid.innerHTML = '';
            
            addCharCard(digitalGrid, 'Empregos TIC', digital.empregos_tic?.toLocaleString('pt-BR') || 'N/D');
            addCharCard(digitalGrid, 'Empresas TIC', digital.empresas_tic?.toLocaleString('pt-BR') || 'N/D');
            addCharCard(digitalGrid, 'Campus Universit√°rios Federais', digital.campus_institutos_universidades_federais || 'N/D');
            addCharCard(digitalGrid, 'Empresas em Parques Tecnol√≥gicos', digital.empresas_parques_tecnologicos || 'N/D');
            addCharCard(digitalGrid, 'Institui√ß√µes de Ensino/Pesquisa P&D', digital.instituicoes_ensino_pesquisa_pdi_lei_tic || 'N/D');
            addCharCard(digitalGrid, 'Empresas Habilitadas Lei TIC', digital.empresas_habilitadas_lei_tic || 'N/D');
            addCharCard(digitalGrid, 'Empresas Lei do Bem (P&D)', digital.empresas_lei_bem_pdi || 'N/D');

            const institutionalGrid = document.getElementById('institutional-grid');
            institutionalGrid.innerHTML = '';
            
            addCharCard(institutionalGrid, 'Tamanho da Equipe TI', institutional.equipe_ti_tamanho || 'N/D');
            addCharCard(institutionalGrid, 'Estrutura Organizacional TIC', institutional.estrutura_organizacional_tic || 'N/D');
            addCharCard(institutionalGrid, 'Incorpora√ß√£o TICs em √Åreas Priorit√°rias', institutional.incorporacao_tics_areas_prioritarias || 'N/D');
            addCharCard(institutionalGrid, 'Respons√°veis pela Governan√ßa Tecnol√≥gica', institutional.governanca_tecnologica_responsaveis || 'N/D');
            addCharCard(institutionalGrid, 'Respons√°vel pela Governan√ßa TI', institutional.governanca_ti_responsavel || 'N/D');
        }

        function addCharCard(container, label, value) {
            const card = document.createElement('div');
            card.className = 'char-card';
            card.innerHTML = `
                <div class="char-label">${label}</div>
                <div class="char-value">${value}</div>
            `;
            container.appendChild(card);
        }

        function changeDimension() {
            const selector = document.getElementById('dimension-selector');
            const dimension = selector.value;
            
            document.querySelectorAll('.dimension-content').forEach(el => {
                el.classList.add('hidden');
            });
            
            if (dimension) {
                document.getElementById(dimension + '-content').classList.remove('hidden');
                renderDimension(dimension);
            }
        }

        function formatIndicatorName(key) {
            const names = {
                'indice_populacao_total_atendimento_agua': '√çndice de Atendimento Total de √Ågua',
                'indice_populacao_total_atendimento_esgoto': '√çndice de Atendimento Total de Esgoto',
                'indice_populacao_urbana_atendimento_esgoto': '√çndice de Atendimento Urbano de Esgoto',
                'taxa_populacao_coberta_coleta_residuos': 'Taxa de Cobertura de Coleta de Res√≠duos',
                'coleta_seletiva_residuos': 'Coleta Seletiva de Res√≠duos',
                'percentual_domicilios_aglomerados_subnormais': 'Domic√≠lios em Aglomerados Subnormais',
                'assentamentos_urbanos_precarios': 'Assentamentos Urbanos Prec√°rios',
                'programas_acoes_habitacionais': 'Programas e A√ß√µes Habitacionais',
                'servicos_regulares_transporte_passageiros': 'Servi√ßos Regulares de Transporte de Passageiros',
                'servicos_compartilhamento_viagens': 'Servi√ßos de Compartilhamento de Viagens',
                'servico_informacoes_transporte_publico_tempo_real': 'Informa√ß√µes de Transporte em Tempo Real',
                'servicos_solucoes_inteligentes_mobilidade': 'Solu√ß√µes Inteligentes de Mobilidade',
                'acessibilidade_transporte_publico': 'Acessibilidade no Transporte P√∫blico',
                'ciclomobilidade': 'Ciclomobilidade',
                'indice_pavimentacao_vias': '√çndice de Pavimenta√ß√£o de Vias',
                'escala_acesso_banda_larga_fixa': 'Acesso √† Banda Larga Fixa',
                'escala_acesso_banda_larga_movel': 'Acesso √† Banda Larga M√≥vel',
                'cobertura_banda_larga_movel_3g_4g': 'Cobertura de Banda Larga M√≥vel 3G/4G',
                'cobertura_fibra_otica': 'Cobertura de Fibra √ìptica',
                'rede_tecnologia_equipamentos_edificios_publicos': 'Rede de Tecnologia em Edif√≠cios P√∫blicos',
                'escala_acesso_banda_larga_fixa_alta_velocidade': 'Acesso √† Banda Larga de Alta Velocidade',
                'numero_estacoes_radio_base': 'N√∫mero de Esta√ß√µes R√°dio Base',
                'qualificacao_profissional_intermediacao_mao_obra': 'Qualifica√ß√£o Profissional e Intermedia√ß√£o',
                'inclusao_produtiva_urbana': 'Inclus√£o Produtiva Urbana',
                'acesso_credito_microcredito_seguro': 'Acesso a Cr√©dito e Microcr√©dito',
                'geracao_trabalho_renda': 'Gera√ß√£o de Trabalho e Renda',
                'sistema_informacao_geografica': 'Sistema de Informa√ß√£o Geogr√°fica',
                'centros_comando_controle': 'Centros de Comando e Controle',
                'plataforma_integrada_cidade_inteligente': 'Plataforma Integrada de Cidade Inteligente',
                'servicos_website_prefeitura': 'Servi√ßos no Website da Prefeitura',
                'dados_abertos_gestao_municipal': 'Dados Abertos da Gest√£o Municipal',
                'indice_volume_esgoto_coletado': '√çndice de Volume de Esgoto Coletado',
                'consumo_medio_per_capita_agua': 'Consumo M√©dio Per Capita de √Ågua',
                'solucoes_inteligentes_gestao_distribuicao_consumo_agua': 'Solu√ß√µes Inteligentes para Gest√£o de √Ågua',
                'indice_perdas_distribuicao_agua': '√çndice de Perdas na Distribui√ß√£o de √Ågua',
                'indice_volume_esgoto_tratado': '√çndice de Volume de Esgoto Tratado',
                'percentual_material_recolhido_coleta_seletiva': 'Material Recolhido pela Coleta Seletiva',
                'solucoes_inteligentes_otimizacao_coleta_residuos': 'Solu√ß√µes Inteligentes para Coleta de Res√≠duos',
                'protecao_gestao_meio_ambiente_areas_verdes_municipio': 'Prote√ß√£o e Gest√£o de √Åreas Verdes',
                'solucoes_monitoramento_gases_efeito_estufa_qualidade_ar': 'Monitoramento de Gases e Qualidade do Ar',
                'monitoramento_qualidade_ar': 'Monitoramento da Qualidade do Ar',
                'solucoes_inteligentes_gestao_consumo_energia_eletrica': 'Gest√£o Inteligente de Energia El√©trica',
                'solucoes_telegestao_iluminacao_publica': 'Telegest√£o de Ilumina√ß√£o P√∫blica',
                'indice_equipamentos_tecnologia_escolas_publicas': 'Equipamentos de Tecnologia em Escolas P√∫blicas',
                'taxa_analfabetismo': 'Taxa de Analfabetismo',
                'ideb_anos_finais': 'IDEB - Anos Finais',
                'vagas_ensino_superior': 'Vagas de Ensino Superior',
                'centros_educacao_tecnologica': 'Centros de Educa√ß√£o Tecnol√≥gica',
                'acoes_educacao_comunidades_especificas': 'A√ß√µes de Educa√ß√£o para Comunidades Espec√≠ficas',
                'taxas_distorcao_idade_serie': 'Taxa de Distor√ß√£o Idade-S√©rie',
                'percentual_escolas_municipais_acesso_internet': 'Escolas Municipais com Acesso √† Internet',
                'computadores_uso_alunos': 'Computadores para Uso de Alunos',
                'estrutura_equipamentos_culturais_esportivos': 'Estrutura de Equipamentos Culturais e Esportivos',
                'protecao_patrimonio_cultural': 'Prote√ß√£o do Patrim√¥nio Cultural',
                'servicos_online_promocao_cultura': 'Servi√ßos Online de Promo√ß√£o Cultural',
                'servicos_culturais_online_populacao': 'Servi√ßos Culturais Online para Popula√ß√£o',
                'servicos_telemedicina_telessaude': 'Servi√ßos de Telemedicina e Telessa√∫de',
                'leitos_hospitalares_rede_publica': 'Leitos Hospitalares na Rede P√∫blica',
                'medicos_disponiveis_rede_publica': 'M√©dicos Dispon√≠veis na Rede P√∫blica',
                'prontuario_eletronico': 'Prontu√°rio Eletr√¥nico',
                'servicos_online_saude_pacientes': 'Servi√ßos Online de Sa√∫de para Pacientes',
                'indice_risco_protecao_saude_nascidos_vivos': '√çndice de Risco e Prote√ß√£o √† Sa√∫de',
                'mortalidade_materna': 'Taxa de Mortalidade Materna',
                'solucoes_monitoramento_seguranca': 'Solu√ß√µes de Monitoramento de Seguran√ßa',
                'taxa_homicidios': 'Taxa de Homic√≠dios',
                'politicas_publicas_acoes_seguranca': 'Pol√≠ticas P√∫blicas de Seguran√ßa',
                'solucoes_tecnologia_monitoramento_desastres': 'Solu√ß√µes Tecnol√≥gicas para Monitoramento de Desastres',
                'vulnerabilidade_riscos_desastres_naturais': 'Vulnerabilidade a Desastres Naturais',
                'promocao_inclusao_digital': 'Promo√ß√£o da Inclus√£o Digital',
                'cursos_capacitacao_tecnologica': 'Cursos de Capacita√ß√£o Tecnol√≥gica',
                'politicas_publicas_mulheres': 'Pol√≠ticas P√∫blicas para Mulheres',
                'inclusao_social_grupos_especificos': 'Inclus√£o Social de Grupos Espec√≠ficos',
                'formas_presenciais_participacao': 'Formas Presenciais de Participa√ß√£o',
                'formas_online_participacao': 'Formas Online de Participa√ß√£o',
                'governanca_colaborativa_responsaveis': 'Governan√ßa Colaborativa - Respons√°veis',
                'incorporacao_tics_planejamento': 'Incorpora√ß√£o de TICs no Planejamento',
                'planejamento_estrategico_transformacao_digital': 'Planejamento Estrat√©gico de Transforma√ß√£o Digital',
                'governanca_ti_praticas': 'Pr√°ticas de Governan√ßa de TI',
                'infraestrutura_hw_sw_armazenamento': 'Infraestrutura de Hardware/Software',
                'gestao_integrada_dados': 'Gest√£o Integrada de Dados',
                'servicos_publicos_online': 'Servi√ßos P√∫blicos Online',
                'solicitacao_servicos_publicos': 'Solicita√ß√£o de Servi√ßos P√∫blicos',
                'seguranca_politicas_publicas_monitoramento': 'Seguran√ßa e Monitoramento de Pol√≠ticas P√∫blicas',
                'percepcao_servicos_publicos': 'Percep√ß√£o dos Servi√ßos P√∫blicos',
                'transparencia_monitoramento': 'Transpar√™ncia e Monitoramento',
                'transparencia_execucao_orcamentaria_financeira': 'Transpar√™ncia da Execu√ß√£o Or√ßament√°ria',
                'transparencia_dados_disponibilizacao': 'Transpar√™ncia e Disponibiliza√ß√£o de Dados',
                'seguranca_dados_praticas': 'Pr√°ticas de Seguran√ßa de Dados'
            };
            
            return names[key] || key.split('_').map(word => 
                word.charAt(0).toUpperCase() + word.slice(1)
            ).join(' ');
        }

        function formatValue(value) {
            if (value === null) return 'N/D';
            if (typeof value === 'boolean') return value ? 'Sim' : 'N√£o';
            if (typeof value === 'number') return value.toLocaleString('pt-BR');
            return value;
        }

        function renderDimension(dimension) {
            const container = document.getElementById(dimension + '-content');
            container.innerHTML = '';

            let data, indicators;

            if (dimension === 'economia') {
                data = economiaData;
                indicators = data.municipio.indicadores;
            } else if (dimension === 'meio_ambiente') {
                data = meioAmbienteData;
                indicators = data.municipio.indicadores;
            } else if (dimension === 'sociocultural') {
                data = socioculturalData;
                indicators = data.municipio.indicadores;
            } else if (dimension === 'capacidades') {
                data = capacidadesData;
                indicators = data.municipio.indicadores;
            }

            for (const [categoryKey, categoryData] of Object.entries(indicators)) {
                const categoryName = formatIndicatorName(categoryKey);
                const categoryIcon = getCategoryIcon(categoryKey);
                
                const categorySection = document.createElement('div');
                categorySection.className = 'category-section';
                
                const categoryTitle = document.createElement('h3');
                categoryTitle.className = 'category-title';
                categoryTitle.textContent = `${categoryIcon} ${categoryName}`;
                categorySection.appendChild(categoryTitle);
                
                const indicatorsGrid = document.createElement('div');
                indicatorsGrid.className = 'indicators-grid';
                
                for (const [indicatorKey, indicatorData] of Object.entries(categoryData)) {
                    const card = document.createElement('div');
                    card.className = 'indicator-card';
                    
                    const name = document.createElement('div');
                    name.className = 'indicator-name';
                    name.textContent = formatIndicatorName(indicatorKey);
                    
                    const value = document.createElement('div');
                    value.className = 'indicator-value';
                    const formattedValue = formatValue(indicatorData.valor);
                    const unit = indicatorData.unidade ? ` ${indicatorData.unidade}` : '';
                    value.textContent = formattedValue + unit;
                    
                    const level = document.createElement('div');
                    level.className = 'indicator-level';
                    const levelBadge = document.createElement('span');
                    levelBadge.className = `nivel-badge nivel-${indicatorData.nivel}`;
                    levelBadge.textContent = indicatorData.nivel;
                    level.appendChild(document.createTextNode('N√≠vel '));
                    level.appendChild(levelBadge);
                    
                    card.appendChild(name);
                    card.appendChild(value);
                    card.appendChild(level);
                    
                    indicatorsGrid.appendChild(card);
                }
                
                categorySection.appendChild(indicatorsGrid);
                container.appendChild(categorySection);
            }
        }

        function getCategoryIcon(category) {
            const icons = {
                'estrategia': 'üéØ',
                'infraestrutura_hw_sw': 'üíª',
                'servicos_aplicacoes': 'üì±',
                'monitoramento': 'üìä',
                'dados_abertos': 'üîì',
                'agua_esgoto': 'üíß',
                'residuos_solidos': '‚ôªÔ∏è',
                'habitacao': 'üèòÔ∏è',
                'transporte': 'üöå',
                'urbanizacao_vias_publicas': 'üõ£Ô∏è',
                'infraestrutura_conectividade': 'üì°',
                'inovacao': 'üí°',
                'sistemas_tecnologia_gestao_urbana': 'üèôÔ∏è',
                'servicos_online_prefeitura': 'üåê',
                'areas_verdes': 'üå≥',
                'qualidade_ar': 'üå¨Ô∏è',
                'energia': '‚ö°',
                'educacao': 'üéì',
                'cultura': 'üé≠',
                'saude': 'üè•',
                'seguranca_publica': 'üõ°Ô∏è',
                'gestao_desastres': 'üö®',
                'inclusao_digital': 'üíª',
                'inclusao_social': 'ü§ù',
                'participacao_publica': 'üó≥Ô∏è'
            };
            return icons[category] || 'üìå';
        }

        document.addEventListener('DOMContentLoaded', function() {
            loadStates();
        });
    </script>
</body>
</html>